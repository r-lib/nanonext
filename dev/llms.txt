# nanonext

R binding for NNG (Nanomsg Next Gen), a successor to ZeroMQ. NNG is a
socket library for reliable, high-performance messaging over in-process,
IPC, TCP, WebSocket and secure TLS transports. Implements ‘Scalability
Protocols’, a standard for common communications patterns including
publish/subscribe, request/reply and service discovery.

As its own [threaded concurrency
framework](https://nanonext.r-lib.org/articles/nanonext.html#async-and-concurrency),
provides a toolkit for asynchronous programming and distributed
computing. Intuitive ‘aio’ objects resolve automatically when
asynchronous operations complete, and [synchronisation
primitives](https://nanonext.r-lib.org/articles/nanonext.html#synchronisation-primitives)
allow R to wait upon events signalled by concurrent threads.

Designed for performance and reliability, nanonext is a lightweight
wrapper around the NNG C library, and is itself implemented almost
entirely in C.

Provides the interface for code and processes to communicate with each
other - [receive data generated in Python, perform analysis in R, and
send results to a C++
program](https://nanonext.r-lib.org/articles/nanonext.html#cross-language-exchange)
– on the same computer or across networks spanning the globe.

Implemented scalability protocols:

- Bus (mesh networks)
- Pair (two-way radio)
- Poly (one-to-one of many)
- Push/Pull (one-way pipeline)
- [Publisher/Subscriber](https://nanonext.r-lib.org/articles/nanonext.html#publisher-subscriber-model)
  (topics & broadcast)
- [Request/Reply](https://nanonext.r-lib.org/articles/nanonext.html#rpc-and-distributed-computing)
  (RPC)
- [Surveyor/Respondent](https://nanonext.r-lib.org/articles/nanonext.html#surveyor-respondent-model)
  (voting & service discovery)

Supported transports:

- inproc (intra-process)
- IPC (inter-process)
- TCP (IPv4 or IPv6)
- WebSocket
- [TLS](https://nanonext.r-lib.org/articles/nanonext.html#tls-secure-connections)
  (over TCP and WebSocket)

Development of the TLS implementation was generously supported by the
![R
Consortium](https://r-consortium.org/images/RConsortium_Horizontal_Pantone.webp)
.

Web utilities:

- [ncurl](https://nanonext.r-lib.org/articles/nanonext.html#ncurl-async-http-client) -
  (async) http(s) client
- [stream](https://nanonext.r-lib.org/articles/nanonext.html#stream-websocket-client) -
  secure websockets client / generic low-level socket interface
- [`ip_addr()`](https://nanonext.r-lib.org/dev/reference/ip_addr.md) -
  for retrieving all local network IP addresses by interface
- [`messenger()`](https://nanonext.r-lib.org/dev/reference/messenger.md) -
  console-based instant messaging with authentication

### Quick Start

nanonext offers 2 equivalent interfaces: a functional interface, and an
object-oriented interface.

#### Functional Interface

The primary object in the functional interface is the Socket. Use
[`socket()`](https://nanonext.r-lib.org/dev/reference/socket.md) to
create a socket and dial or listen at an address. The socket is then
passed as the first argument of subsequent actions such as
[`send()`](https://nanonext.r-lib.org/dev/reference/send.md) or
[`recv()`](https://nanonext.r-lib.org/dev/reference/recv.md).

*Example using Request/Reply (REQ/REP) protocol with inproc
transport:*  
(The inproc transport uses zero-copy where possible for a much faster
solution than alternatives)

Create sockets:

``` r
library(nanonext)

socket1 <- socket("req", listen = "inproc://nanonext")
socket2 <- socket("rep", dial = "inproc://nanonext")
```

Send message from ‘socket1’:

``` r
send(socket1, "hello world!")
#> [1] 0
```

Receive message using ‘socket2’:

``` r
recv(socket2)
#> [1] "hello world!"
```

#### Object-oriented Interface

The primary object in the object-oriented interface is the nano object.
Use [`nano()`](https://nanonext.r-lib.org/dev/reference/nano.md) to
create a nano object which encapsulates a Socket and Dialer/Listener.
Methods such as `$send()` or `$recv()` can then be accessed directly
from the object.

*Example using Pipeline (Push/Pull) protocol with TCP/IP transport:*

Create nano objects:

``` r
library(nanonext)

nano1 <- nano("push", listen = "tcp://127.0.0.1:5555")
nano2 <- nano("pull", dial = "tcp://127.0.0.1:5555")
```

Send message from ‘nano1’:

``` r
nano1$send("hello world!")
#> [1] 0
```

Receive message using ‘nano2’:

``` r
nano2$recv()
#> [1] "hello world!"
```

### Vignette

Please refer to the [nanonext
vignette](https://nanonext.r-lib.org/articles/nanonext.html) for full
package functionality.

This may be accessed within R by:

``` r
vignette("nanonext", package = "nanonext")
```

### Installation

Install the latest release from CRAN:

``` r
install.packages("nanonext")
```

Or the current development version from R-universe:

``` r
install.packages("nanonext", repos = "https://r-lib.r-universe.dev")
```

### Building from Source

#### Linux / Mac / Solaris

Installation from source requires ‘libnng’ \>= v1.9.0 and ‘libmbedtls’
\>= 2.5.0 (suitable installations are automatically detected), or else
‘cmake’ to compile ‘libnng’ v1.11.0 and ‘libmbedtls’ v3.6.5 included
within the package sources.

**It is recommended for optimal performance and stability to let the
package automatically compile bundled versions of ‘libmbedtls’ and
‘libnng’ during installation.** To ensure the libraries are compiled
from source even if system installations are present, set the
`NANONEXT_LIBS` environment variable prior to installation e.g. by
`Sys.setenv(NANONEXT_LIBS = 1)`.

As system libraries, ‘libnng’ is available as libnng-dev (deb) or
nng-devel (rpm), and ‘libmbedtls’ as libmbedtls-dev (deb) or
libmbedtls-devel (rpm). The `INCLUDE_DIR` and `LIB_DIR` environment
variables may be set prior to package installation to specify a custom
location for ‘libmbedtls’ or ‘libnng’ other than the standard filesystem
locations.

*Solaris: requires a more recent version of ‘cmake’ than available on
OpenCSW - refer to the ‘cmake’ website for the latest source file.*

#### Windows

On Windows, ‘libnng’ v1.11.0 and ‘libmbedtls’ v3.6.5 will be compiled
from the package sources during installation and hence requires the
‘Rtools’ toolchain.

For R \>= 4.2 using the ‘Rtools42’ or newer toolchains, the prerequisite
‘cmake’ is included. For previous R versions using ‘Rtools40’ or
earlier, it may be necessary to separately install a version of ‘cmake’
in Windows and ensure that it is added to your system’s `PATH`.

### Acknowledgements

- [Garrett D’Amore](https://github.com/gdamore), author of the NNG
  library, for generous advice and for implementing a feature request
  specifically for a more efficient ‘aio’ implementation in `nanonext`.
- The [R Consortium](https://r-consortium.org/) for funding the
  development of the secure TLS capabilities in the package, and [Henrik
  Bengtsson](https://github.com/HenrikBengtsson) and [Will
  Landau](https://github.com/wlandau/)’s roles in making this possible.
- [Joe Cheng](https://github.com/jcheng5/) for prototyping the
  integration of `nanonext` with `later` to support the next generation
  of completely event-driven ‘promises’.
- [Luke Tierney](https://github.com/ltierney/) (R Core) and [Mike
  Cheng](https://github.com/coolbutuseless) for meticulous documentation
  of the R serialization mechanism, which led to the package’s own
  implementation of a low-level interface to R serialization.
- [Travers Ching](https://github.com/traversc) for a novel idea in
  extending the original custom serialization support in the package.
- [Jeroen Ooms](https://github.com/jeroen) - for his ‘Anticonf (tm)’
  configure script, on which our original ‘configure’ was based,
  although much modified since.

### Links

[nanonext](https://nanonext.r-lib.org/) • [CRAN HPC Task
View](https://cran.r-project.org/view=HighPerformanceComputing) • [CRAN
Web Technologies Task
View](https://cran.r-project.org/view=WebTechnologies) •
[NNG](https://nng.nanomsg.org/) • [Mbed
TLS](https://www.trustedfirmware.org/projects/mbed-tls/)

–

Please note that this project is released with a [Contributor Code of
Conduct](https://nanonext.r-lib.org/CODE_OF_CONDUCT.html). By
participating in this project you agree to abide by its terms.

# Package index

- [`nanonext`](https://nanonext.r-lib.org/dev/reference/nanonext-package.md)
  [`nanonext-package`](https://nanonext.r-lib.org/dev/reference/nanonext-package.md)
  : nanonext: NNG (Nanomsg Next Gen) Lightweight Messaging Library
- [`as.promise(`*`<ncurlAio>`*`)`](https://nanonext.r-lib.org/dev/reference/as.promise.ncurlAio.md)
  : Make ncurlAio Promise
- [`as.promise(`*`<recvAio>`*`)`](https://nanonext.r-lib.org/dev/reference/as.promise.recvAio.md)
  : Make recvAio Promise
- [`call_aio()`](https://nanonext.r-lib.org/dev/reference/call_aio.md)
  [`call_aio_()`](https://nanonext.r-lib.org/dev/reference/call_aio.md)
  : Call the Value of an Asynchronous Aio Operation
- [`close(`*`<nanoContext>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  [`close(`*`<nanoDialer>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  [`close(`*`<nanoListener>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  [`close(`*`<ncurlSession>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  [`close(`*`<nanoSocket>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  [`close(`*`<nanoStream>`*`)`](https://nanonext.r-lib.org/dev/reference/close.md)
  : Close Connection
- [`collect_aio()`](https://nanonext.r-lib.org/dev/reference/collect_aio.md)
  [`collect_aio_()`](https://nanonext.r-lib.org/dev/reference/collect_aio.md)
  : Collect Data of an Aio or List of Aios
- [`context()`](https://nanonext.r-lib.org/dev/reference/context.md) :
  Open Context
- [`cv()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`wait()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`wait_()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`until()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`until_()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`cv_value()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`cv_reset()`](https://nanonext.r-lib.org/dev/reference/cv.md)
  [`cv_signal()`](https://nanonext.r-lib.org/dev/reference/cv.md) :
  Condition Variables
- [`dial()`](https://nanonext.r-lib.org/dev/reference/dial.md) : Dial an
  Address from a Socket
- [`.context()`](https://nanonext.r-lib.org/dev/reference/dot-context.md)
  : Technical Utility: Open Context
- [`` `%~>%` ``](https://nanonext.r-lib.org/dev/reference/grapes-twiddle-greater-than-grapes.md)
  : Signal Forwarder
- [`ip_addr()`](https://nanonext.r-lib.org/dev/reference/ip_addr.md) :
  IP Address
- [`is_aio()`](https://nanonext.r-lib.org/dev/reference/is_aio.md)
  [`is_nano()`](https://nanonext.r-lib.org/dev/reference/is_aio.md)
  [`is_ncurl_session()`](https://nanonext.r-lib.org/dev/reference/is_aio.md)
  : Validators
- [`is_error_value()`](https://nanonext.r-lib.org/dev/reference/is_error_value.md)
  [`is_nul_byte()`](https://nanonext.r-lib.org/dev/reference/is_error_value.md)
  : Error Validators
- [`listen()`](https://nanonext.r-lib.org/dev/reference/listen.md) :
  Listen to an Address from a Socket
- [`mclock()`](https://nanonext.r-lib.org/dev/reference/mclock.md) :
  Clock Utility
- [`messenger()`](https://nanonext.r-lib.org/dev/reference/messenger.md)
  : Messenger
- [`monitor()`](https://nanonext.r-lib.org/dev/reference/monitor.md)
  [`read_monitor()`](https://nanonext.r-lib.org/dev/reference/monitor.md)
  : Monitor a Socket for Pipe Changes
- [`msleep()`](https://nanonext.r-lib.org/dev/reference/msleep.md) :
  Sleep Utility
- [`nano()`](https://nanonext.r-lib.org/dev/reference/nano.md) : Create
  Nano Object
- [`ncurl()`](https://nanonext.r-lib.org/dev/reference/ncurl.md) : ncurl
- [`ncurl_aio()`](https://nanonext.r-lib.org/dev/reference/ncurl_aio.md)
  : ncurl Async
- [`ncurl_session()`](https://nanonext.r-lib.org/dev/reference/ncurl_session.md)
  [`transact()`](https://nanonext.r-lib.org/dev/reference/ncurl_session.md)
  : ncurl Session
- [`nng_error()`](https://nanonext.r-lib.org/dev/reference/nng_error.md)
  : Translate Error Codes
- [`nng_version()`](https://nanonext.r-lib.org/dev/reference/nng_version.md)
  : NNG Library Version
- [`opt()`](https://nanonext.r-lib.org/dev/reference/opt.md)
  [`` `opt<-`() ``](https://nanonext.r-lib.org/dev/reference/opt.md) :
  Get and Set Options for a Socket, Context, Stream, Listener or Dialer
- [`parse_url()`](https://nanonext.r-lib.org/dev/reference/parse_url.md)
  : Parse URL
- [`pipe_id()`](https://nanonext.r-lib.org/dev/reference/pipe_id.md) :
  Get the Pipe ID of a recvAio
- [`pipe_notify()`](https://nanonext.r-lib.org/dev/reference/pipe_notify.md)
  : Pipe Notify
- [`protocols`](https://nanonext.r-lib.org/dev/reference/protocols.md) :
  Protocols (Documentation)
- [`random()`](https://nanonext.r-lib.org/dev/reference/random.md) :
  Random Data Generation
- [`read_stdin()`](https://nanonext.r-lib.org/dev/reference/read_stdin.md)
  : Read stdin
- [`reap()`](https://nanonext.r-lib.org/dev/reference/reap.md) : Reap
- [`recv()`](https://nanonext.r-lib.org/dev/reference/recv.md) : Receive
- [`recv_aio()`](https://nanonext.r-lib.org/dev/reference/recv_aio.md) :
  Receive Async
- [`reply()`](https://nanonext.r-lib.org/dev/reference/reply.md) : Reply
  over Context (RPC Server for Req/Rep Protocol)
- [`request()`](https://nanonext.r-lib.org/dev/reference/request.md) :
  Request over Context (RPC Client for Req/Rep Protocol)
- [`send()`](https://nanonext.r-lib.org/dev/reference/send.md) : Send
- [`send_aio()`](https://nanonext.r-lib.org/dev/reference/send_aio.md) :
  Send Async
- [`serial_config()`](https://nanonext.r-lib.org/dev/reference/serial_config.md)
  : Create Serialization Configuration
- [`socket()`](https://nanonext.r-lib.org/dev/reference/socket.md) :
  Open Socket
- [`start(`*`<nanoListener>`*`)`](https://nanonext.r-lib.org/dev/reference/start.md)
  [`start(`*`<nanoDialer>`*`)`](https://nanonext.r-lib.org/dev/reference/start.md)
  : Start Listener/Dialer
- [`stat()`](https://nanonext.r-lib.org/dev/reference/stat.md) : Get
  Statistic for a Socket, Listener or Dialer
- [`status_code()`](https://nanonext.r-lib.org/dev/reference/status_code.md)
  : Translate HTTP Status Codes
- [`stop_aio()`](https://nanonext.r-lib.org/dev/reference/stop_aio.md) :
  Stop Asynchronous Aio Operation
- [`stream()`](https://nanonext.r-lib.org/dev/reference/stream.md) :
  Open Stream
- [`subscribe()`](https://nanonext.r-lib.org/dev/reference/subscribe.md)
  [`unsubscribe()`](https://nanonext.r-lib.org/dev/reference/subscribe.md)
  : Subscribe / Unsubscribe Topic
- [`survey_time()`](https://nanonext.r-lib.org/dev/reference/survey_time.md)
  : Set Survey Time
- [`tls_config()`](https://nanonext.r-lib.org/dev/reference/tls_config.md)
  : Create TLS Configuration
- [`transports`](https://nanonext.r-lib.org/dev/reference/transports.md)
  : Transports (Documentation)
- [`unresolved()`](https://nanonext.r-lib.org/dev/reference/unresolved.md)
  : Query if an Aio is Unresolved
- [`write_cert()`](https://nanonext.r-lib.org/dev/reference/write_cert.md)
  : Generate Self-Signed Certificate and Key
- [`write_stdout()`](https://nanonext.r-lib.org/dev/reference/write_stdout.md)
  : Write to Stdout

# Articles

### All vignettes

- [nanonext - NNG Lightweight Messaging
  Library](https://nanonext.r-lib.org/dev/articles/nanonext.md):
